BEGIN PROGRAM

    FUNCTION create_question(difficulty):
        IF difficulty = "easy" THEN
            number_range ← 1 to 10
        ELSE IF difficulty = "medium" THEN
            number_range ← 1 to 25
        ELSE
            number_range ← 1 to 50
        END IF

        num1 ← RANDOM number in number_range
        num2 ← RANDOM number in number_range
        operator ← RANDOM choice from {"+", "-", "*"}

        // Ensure subtraction never gives negative answers
        IF operator = "-" AND num2 > num1 THEN
            SWAP num1 and num2
        END IF

        expression ← STRING "num1 operator num2"
        correct_answer ← EVALUATE(expression)

        RETURN expression, correct_answer
    END FUNCTION


    FUNCTION ask_question(expression, correct_answer):
        DISPLAY "What is expression?"
        start_time ← CURRENT TIME

        TRY
            user_input ← INTEGER(INPUT)
        CATCH error:
            DISPLAY "Invalid input"
            RETURN 0, NONE, CURRENT TIME - start_time
        END TRY

        end_time ← CURRENT TIME
        elapsed_time ← end_time - start_time

        IF user_input = correct_answer THEN
            IF elapsed_time ≤ 5 THEN
                score ← 2
            ELSE
                score ← 1
            END IF
            DISPLAY "Correct! Points awarded"
        ELSE
            score ← 0
            DISPLAY "Incorrect, correct answer was correct_answer"
        END IF

        RETURN score, user_input, elapsed_time
    END FUNCTION


    FUNCTION maths_quiz():
        DISPLAY "Welcome to Maths Quiz"
        DISPLAY "Choose difficulty: 1 Easy, 2 Medium, 3 Hard"

        REPEAT
            choice ← INPUT
            IF choice = "1" THEN
                difficulty ← "easy"
                total_questions ← 5
                valid ← TRUE
            ELSE IF choice = "2" THEN
                difficulty ← "medium"
                total_questions ← 8
                valid ← TRUE
            ELSE IF choice = "3" THEN
                difficulty ← "hard"
                total_questions ← 12
                valid ← TRUE
            ELSE
                DISPLAY "Invalid selection"
                valid ← FALSE
            END IF
        UNTIL valid = TRUE

        DISPLAY "You selected difficulty mode"

        total_score ← 0
        results ← EMPTY LIST

        FOR question_number FROM 1 TO total_questions DO
            expression, correct_answer ← create_question(difficulty)
            DISPLAY "Question question_number of total_questions"
            score, user_input, elapsed_time ← ask_question(expression, correct_answer)
            total_score ← total_score + score
            APPEND (expression, correct_answer, user_input, score, elapsed_time) TO results
        END FOR

        // Final results summary
        DISPLAY "Quiz Completed"
        DISPLAY "Final Score: total_score / (total_questions * 2)"
        percentage ← (total_score / (total_questions * 2)) * 100
        DISPLAY "Percentage: percentage %"

        // Question breakdown
        DISPLAY "No. Question   Your Ans   Correct Ans   Score   Time"
        FOR EACH result IN results DO
            DISPLAY result
        END FOR
    END FUNCTION


    CALL maths_quiz()

END PROGRAM
